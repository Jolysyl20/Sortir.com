{% extends 'base.html.twig' %}
{% block title %}Sortir.com - Accueil{% endblock %}
{% block body %}



  <div class="row" style="margin-top:2%">
    <div class=col-6>
        {% if user.siteParticipant.nom == 'Saint Herblain' %}
          <!-- weather widget start Nantes-->
          <div style="margin-left:14%; margin-top: 4%;">
          <div id="m-booked-prime-days-31665"> <div class="weather-customize widget-type-prime-days">  <div class="booked-prime-days-in"> <div class="booked-prime-days-data"> <div class="booked-pd-today"> <div class="booked-pd-today-img wrz-01 "></div> <div class="booked-pd-today-temperature"> <div class="booked-wzs-pd-val"> <div class="booked-wzs-pd-number"><span class="plus">+</span>15</div> <div class="booked-wzs-pd-dergee"> <div class="booked-wzs-pd-dergee-val">&deg;</div> <div class="booked-wzs-pd-dergee-name">C</div> </div> </div> </div> <div class="booked-pd-today-extreme"> <div class="booked-pd booked-pd-h"><span>Max:</span><span class="plus">+</span>17</div> <div class="booked-pd booked-pd-l"><span>Min:</span><span class="plus">+</span>7</div> </div> </div> <div class="booked-pd-ndays">  <div class="booked-pd-nitem"> <div class="booked-pd-nidi wrz-sml wrzs-03"></div> <div class="booked-pd-nidw">Ven.</div> </div>  <div class="booked-pd-nitem"> <div class="booked-pd-nidi wrz-sml wrzs-01"></div> <div class="booked-pd-nidw">Sam.</div> </div>  <div class="booked-pd-nitem"> <div class="booked-pd-nidi wrz-sml wrzs-03"></div> <div class="booked-pd-nidw">Dim.</div> </div>  <div class="booked-pd-nitem"> <div class="booked-pd-nidi wrz-sml wrzs-18"></div> <div class="booked-pd-nidw">Lun.</div> </div> </div> </div> </div> </div> </div><script type="text/javascript"> var css_file=document.createElement("link"); var widgetUrl = location.href; css_file.setAttribute("rel","stylesheet"); css_file.setAttribute("type","text/css"); css_file.setAttribute("href",'https://s.bookcdn.com/css/w/booked-wzs-widget-prime-days.css?v=0.0.1'); document.getElementsByTagName("head")[0].appendChild(css_file); function setWidgetData_31665(data) { if(typeof(data) != 'undefined' && data.results.length > 0) { for(var i = 0; i < data.results.length; ++i) { var objMainBlock = document.getElementById('m-booked-prime-days-31665'); if(objMainBlock !== null) { var copyBlock = document.getElementById('m-bookew-weather-copy-'+data.results[i].widget_type); objMainBlock.innerHTML = data.results[i].html_code; if(copyBlock !== null) objMainBlock.appendChild(copyBlock); } } } else { alert('data=undefined||data.results is empty'); } } var widgetSrc = "https://widgets.booked.net/weather/info?action=get_weather_info;ver=7;cityID=876;type=6;scode=124;ltid=3458;domid=581;anc_id=92015;countday=undefined;cmetric=1;wlangID=3;color=137AE9;wwidth=160;header_color=ffffff;text_color=333333;link_color=08488D;border_form=1;footer_color=ffffff;footer_text_color=333333;transparent=0;v=0.0.1";widgetSrc += ';ref=' + widgetUrl;widgetSrc += ';rand_id=31665';var weatherBookedScript = document.createElement("script"); weatherBookedScript.setAttribute("type", "text/javascript"); weatherBookedScript.src = widgetSrc; document.body.appendChild(weatherBookedScript) </script>
          </div>
          <!-- weather widget end -->
           {% elseif user.siteParticipant.nom =='Quinper'%}
             <!-- weather widget start Rennes -->
            <div style="margin-left:14%; margin-top: 4%;">
            <div id="m-booked-prime-days-60796"> <div class="weather-customize widget-type-prime-days">  <div class="booked-prime-days-in"> <div class="booked-prime-days-data"> <div class="booked-pd-today"> <div class="booked-pd-today-img wrz-01 "></div> <div class="booked-pd-today-temperature"> <div class="booked-wzs-pd-val"> <div class="booked-wzs-pd-number"><span class="plus">+</span>15</div> <div class="booked-wzs-pd-dergee"> <div class="booked-wzs-pd-dergee-val">&deg;</div> <div class="booked-wzs-pd-dergee-name">C</div> </div> </div> </div> <div class="booked-pd-today-extreme"> <div class="booked-pd booked-pd-h"><span>Max:</span><span class="plus">+</span>17</div> <div class="booked-pd booked-pd-l"><span>Min:</span><span class="plus">+</span>7</div> </div> </div> <div class="booked-pd-ndays">  <div class="booked-pd-nitem"> <div class="booked-pd-nidi wrz-sml wrzs-03"></div> <div class="booked-pd-nidw">Ven.</div> </div>  <div class="booked-pd-nitem"> <div class="booked-pd-nidi wrz-sml wrzs-06"></div> <div class="booked-pd-nidw">Sam.</div> </div>  <div class="booked-pd-nitem"> <div class="booked-pd-nidi wrz-sml wrzs-03"></div> <div class="booked-pd-nidw">Dim.</div> </div>  <div class="booked-pd-nitem"> <div class="booked-pd-nidi wrz-sml wrzs-18"></div> <div class="booked-pd-nidw">Lun.</div> </div> </div> </div> </div> </div> </div><script type="text/javascript"> var css_file=document.createElement("link"); var widgetUrl = location.href; css_file.setAttribute("rel","stylesheet"); css_file.setAttribute("type","text/css"); css_file.setAttribute("href",'https://s.bookcdn.com/css/w/booked-wzs-widget-prime-days.css?v=0.0.1'); document.getElementsByTagName("head")[0].appendChild(css_file); function setWidgetData_60796(data) { if(typeof(data) != 'undefined' && data.results.length > 0) { for(var i = 0; i < data.results.length; ++i) { var objMainBlock = document.getElementById('m-booked-prime-days-60796'); if(objMainBlock !== null) { var copyBlock = document.getElementById('m-bookew-weather-copy-'+data.results[i].widget_type); objMainBlock.innerHTML = data.results[i].html_code; if(copyBlock !== null) objMainBlock.appendChild(copyBlock); } } } else { alert('data=undefined||data.results is empty'); } } var widgetSrc = "https://widgets.booked.net/weather/info?action=get_weather_info;ver=7;cityID=924;type=6;scode=124;ltid=3457;domid=581;anc_id=71892;countday=undefined;cmetric=1;wlangID=3;color=137AE9;wwidth=160;header_color=ffffff;text_color=333333;link_color=08488D;border_form=1;footer_color=ffffff;footer_text_color=333333;transparent=0;v=0.0.1";widgetSrc += ';ref=' + widgetUrl;widgetSrc += ';rand_id=60796';var weatherBookedScript = document.createElement("script"); weatherBookedScript.setAttribute("type", "text/javascript"); weatherBookedScript.src = widgetSrc; document.body.appendChild(weatherBookedScript) </script>
            </div>
             <!-- weather widget end -->
           {% elseif user.siteParticipant.nom =='Rennes'%}
             <!-- weather widget start Rennes-->
              <div style="margin-left:14%; margin-top: 4%;">
              <div id="m-booked-prime-days-60796"> <div class="weather-customize widget-type-prime-days">  <div class="booked-prime-days-in"> <div class="booked-prime-days-data"> <div class="booked-pd-today"> <div class="booked-pd-today-img wrz-01 "></div> <div class="booked-pd-today-temperature"> <div class="booked-wzs-pd-val"> <div class="booked-wzs-pd-number"><span class="plus">+</span>15</div> <div class="booked-wzs-pd-dergee"> <div class="booked-wzs-pd-dergee-val">&deg;</div> <div class="booked-wzs-pd-dergee-name">C</div> </div> </div> </div> <div class="booked-pd-today-extreme"> <div class="booked-pd booked-pd-h"><span>Max:</span><span class="plus">+</span>17</div> <div class="booked-pd booked-pd-l"><span>Min:</span><span class="plus">+</span>7</div> </div> </div> <div class="booked-pd-ndays">  <div class="booked-pd-nitem"> <div class="booked-pd-nidi wrz-sml wrzs-03"></div> <div class="booked-pd-nidw">Ven.</div> </div>  <div class="booked-pd-nitem"> <div class="booked-pd-nidi wrz-sml wrzs-06"></div> <div class="booked-pd-nidw">Sam.</div> </div>  <div class="booked-pd-nitem"> <div class="booked-pd-nidi wrz-sml wrzs-03"></div> <div class="booked-pd-nidw">Dim.</div> </div>  <div class="booked-pd-nitem"> <div class="booked-pd-nidi wrz-sml wrzs-18"></div> <div class="booked-pd-nidw">Lun.</div> </div> </div> </div> </div> </div> </div><script type="text/javascript"> var css_file=document.createElement("link"); var widgetUrl = location.href; css_file.setAttribute("rel","stylesheet"); css_file.setAttribute("type","text/css"); css_file.setAttribute("href",'https://s.bookcdn.com/css/w/booked-wzs-widget-prime-days.css?v=0.0.1'); document.getElementsByTagName("head")[0].appendChild(css_file); function setWidgetData_60796(data) { if(typeof(data) != 'undefined' && data.results.length > 0) { for(var i = 0; i < data.results.length; ++i) { var objMainBlock = document.getElementById('m-booked-prime-days-60796'); if(objMainBlock !== null) { var copyBlock = document.getElementById('m-bookew-weather-copy-'+data.results[i].widget_type); objMainBlock.innerHTML = data.results[i].html_code; if(copyBlock !== null) objMainBlock.appendChild(copyBlock); } } } else { alert('data=undefined||data.results is empty'); } } var widgetSrc = "https://widgets.booked.net/weather/info?action=get_weather_info;ver=7;cityID=924;type=6;scode=124;ltid=3457;domid=581;anc_id=71892;countday=undefined;cmetric=1;wlangID=3;color=137AE9;wwidth=160;header_color=ffffff;text_color=333333;link_color=08488D;border_form=1;footer_color=ffffff;footer_text_color=333333;transparent=0;v=0.0.1";widgetSrc += ';ref=' + widgetUrl;widgetSrc += ';rand_id=60796';var weatherBookedScript = document.createElement("script"); weatherBookedScript.setAttribute("type", "text/javascript"); weatherBookedScript.src = widgetSrc; document.body.appendChild(weatherBookedScript) </script>
              </div>
               <!-- weather widget end -->
           {% else %}
          <!-- weather widget start Niort-->
           <div style="margin-left:14%; margin-top: 4%;">
           <div id="m-booked-prime-days-68050"> <div class="weather-customize widget-type-prime-days">  <div class="booked-prime-days-in"> <div class="booked-prime-days-data"> <div class="booked-pd-today"> <div class="booked-pd-today-img wrz-01 "></div> <div class="booked-pd-today-temperature"> <div class="booked-wzs-pd-val"> <div class="booked-wzs-pd-number"><span class="plus">+</span>17</div> <div class="booked-wzs-pd-dergee"> <div class="booked-wzs-pd-dergee-val">&deg;</div> <div class="booked-wzs-pd-dergee-name">C</div> </div> </div> </div> <div class="booked-pd-today-extreme"> <div class="booked-pd booked-pd-h"><span>Max:</span><span class="plus">+</span>20</div> <div class="booked-pd booked-pd-l"><span>Min:</span><span class="plus">+</span>6</div> </div> </div> <div class="booked-pd-ndays">  <div class="booked-pd-nitem"> <div class="booked-pd-nidi wrz-sml wrzs-03"></div> <div class="booked-pd-nidw">Ven.</div> </div>  <div class="booked-pd-nitem"> <div class="booked-pd-nidi wrz-sml wrzs-01"></div> <div class="booked-pd-nidw">Sam.</div> </div>  <div class="booked-pd-nitem"> <div class="booked-pd-nidi wrz-sml wrzs-03"></div> <div class="booked-pd-nidw">Dim.</div> </div>  <div class="booked-pd-nitem"> <div class="booked-pd-nidi wrz-sml wrzs-03"></div> <div class="booked-pd-nidw">Lun.</div> </div> </div> </div> </div> </div> </div><script type="text/javascript"> var css_file=document.createElement("link"); var widgetUrl = location.href; css_file.setAttribute("rel","stylesheet"); css_file.setAttribute("type","text/css"); css_file.setAttribute("href",'https://s.bookcdn.com/css/w/booked-wzs-widget-prime-days.css?v=0.0.1'); document.getElementsByTagName("head")[0].appendChild(css_file); function setWidgetData_68050(data) { if(typeof(data) != 'undefined' && data.results.length > 0) { for(var i = 0; i < data.results.length; ++i) { var objMainBlock = document.getElementById('m-booked-prime-days-68050'); if(objMainBlock !== null) { var copyBlock = document.getElementById('m-bookew-weather-copy-'+data.results[i].widget_type); objMainBlock.innerHTML = data.results[i].html_code; if(copyBlock !== null) objMainBlock.appendChild(copyBlock); } } } else { alert('data=undefined||data.results is empty'); } } var widgetSrc = "https://widgets.booked.net/weather/info?action=get_weather_info;ver=7;cityID=16762;type=6;scode=124;ltid=3457;domid=581;anc_id=77969;countday=undefined;cmetric=1;wlangID=3;color=137AE9;wwidth=160;header_color=ffffff;text_color=333333;link_color=08488D;border_form=1;footer_color=ffffff;footer_text_color=333333;transparent=0;v=0.0.1";widgetSrc += ';ref=' + widgetUrl;widgetSrc += ';rand_id=68050';var weatherBookedScript = document.createElement("script"); weatherBookedScript.setAttribute("type", "text/javascript"); weatherBookedScript.src = widgetSrc; document.body.appendChild(weatherBookedScript) </script>
           </div>
           <!-- weather widget end -->
        {% endif %}
    </div>
    <div class="col-6">
    <div class="bonjour">
      <marquee scrolldelay=200  behavior="alternate">
        <h3 class="textColor" style='margin-top:2%'><a href="{{ path ('afficherProfil', {id : user.id }) }}">{{ user.prenom }} </a></h3>
      </marquee>
    </div>
      <h4 class="textColor">Nous sommes aujourd'hui le  {{ 'now'|date('d/m/Y') }}</h4>
    </div>
  </div>

  <!-- Recherche -->
  <div id="corps">
    <form method="post" action="{{ path('accueil') }}">
      <div class="row">
        <div class="col-md-6">
          <div class="input-group mb-3">
            <label class="input-group-text" for="inputGroupSelect01">Site</label>
            <select class="form-select" name="site">
              <option value="moelleuxAuxPommes" selected>choisir un site</option>
                {% for s in sortie %}
                  <option value="{{s.sitesortie.id}}">{{s.sitesortie.nom}}</option>
                {% endfor %}
            </select>
          </div>
          <div class="input-group mb-3">
            <label class="input-group-text" id="inputGroup-sizing-default">Nom de la sortie</label>
            <input type="text" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default"name="containerName">
          </div>
          <div class="input-group mb-3">
            <label class="input-group-text" id="inputGroup-sizing-default1">Entre</label>
            <input name="dateEntre" type="datetime-local" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default1">
            <label class="input-group-text" id="inputGroup-sizing-default2">Et</label>
            <input name="dateEt" type="datetime-local" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default2">
          </div>
          <div class="col-md-5"></div>
        </div>
        <div class="col-md-4" >
          <div class="form-check">
            <input class="form-check-input" type="checkbox" name="organisateur" value="true" id="flexCheckIndeterminate">
            <label class="form-check-label" for="flexCheckIndeterminate">Sorties dont je suis l'organisateur/trice</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" name="inscrit" value="{{app.user.id}}" id="flexCheckIndeterminate">
            <label class="form-check-label" for="flexCheckIndeterminate">Sorties auxquelles je suis inscrit/e</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" name="noInscrit" value="{{app.user.id}}" id="flexCheckIndeterminate">
            <label class="form-check-label" for="flexCheckIndeterminate">Sorties auxquelles je ne suis pas inscrit/e</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" name="end" value="true" id="flexCheckIndeterminate">
            <label class="form-check-label" for="flexCheckIndeterminate">Sorties passées</label>
          </div>
        </div>
        <div class="col-md-2">
          <button class="btnRecherche box" value="recherche" name="sub" type="submit"> <i class="bi bi-search">Rechercher</i></button>
        </div>
      </div>
    </form>
  <!--Tableau-->
  <table class="table" id="table" >
    <thead >
      <tr>
        <th scope="col">Nom de la sortie</th>
        <th scope="col">Date de la sortie</th>
        <th scope="col">Cloture</th>
        <th scope="col">Nombre d'inscrits</th>
        <th scope="col">Etat</th>
        <th scope="col">Inscrit</th>
        <th scope="col">Organisateur</th>
        <th scope="col">Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for s in sortie %}
        <tr {% if (s.dateCloture|date('d/m/Y H:i')) <= 'now'|date('d/m/Y') %}class="barre" {% endif %}>
          <td >{{ s.nom }} </td>
          <td>{{ s.dateDebut|date('d/m/Y H:i') }}</td>
          <td>{{ s.dateCloture|date('d/m/Y H:i') }}</td>
          <td {%if ( s.inscriptions|length >= s.nbInscriptionMax) %} class="clignote" id="depasse" {% endif %}>
            {{ s.inscriptions|length }}/{{s.nbInscriptionMax|number_format }}
          </td>
          <td>{{ s.noEtat.libelle }}</td>
          <td>
            {% for i in s.getInscriptions %}
              {% if i.getNoParticipant().getId() == app.user.id %}
                <i name="check" class="bi bi-check-lg"></i>
              {% endif %}
            {% endfor %}
          </td>
          <td><a href="{{ path ('afficherProfil', {id : s.organisateur.id }) }}">{{s.organisateur.pseudo}}</a></td>


          <!-- BOUTONS -->
          <!-- BTN VOIR SORTIE-->
          <td >
            {% if s.noEtat.libelle != "creee" %}
              <a class="btn btn-info" href="{{path('afficher_sortie',{id : s.id })}}">
                <i class="bi bi-eye"></i>
              </a>
            {% endif %}
            <!-- BTN ETAT SORTIE-->
            {% if s.noEtat.libelle == "Ouverte" %}
              {% if s.inscriptions|length <= 0 %}
                <a class="btn btn-success" href="{{ path ('inscription_sortie', {id : s.id }) }}"><i class="bi bi-person-check-fill"></i></a>
              {% endif %}
              {% for i in s.getInscriptions() %}
                {% if dejaInscrit %}
                  <a class="btn btn-warning" name="desinscrit" href="{{ path ('desister', {id : s.id }) }}"><i class="bi bi-x-circle"></i></a>
                {% else %}
                 <a class="btn btn-success"  href="{{ path ('inscription_sortie', {id : s.id }) }}"><i class="bi bi-person-check-fill"></i></a>
                {% endif %}
              {% endfor %}
            {% endif %}
            {% if s.organisateur.id == app.user.id %}
              <a class="btn btn-primary"  href="{{ path ('modifier_sortie', {id : s.id }) }}">
                <i class="bi bi-pencil-square"></i>
              </a>
            {% endif %}
            {% if s.organisateur.pseudo == app.user.id %}
              {% if s.noEtat.libelle == "creee" %}
                <a class="btn btn-success" href="{{ path ('publier_sortie', {id : s.id }) }}">
                  <i class="bi bi-pin-angle"></i>
                </a>
              {% endif %}
            {% endif %}
            {% if s.organisateur.pseudo == app.user.pseudo %}
              <a class="btn btn-danger" href="{{ path ('annuler_sortie',{id : s.id }) }}">
                <i class="bi bi-calendar-x"></i>
              </a>
            {% endif %}
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
  <div style="text-align:center">
    <div class="wrapper">
      <h3>Proposer une nouvelle sortie</h3>
        <a href="{{ path('nouvelle_sortie') }}" class="btn btn-outline-primary " style="widht:10%; border-radius:90px " ><i class="bi bi-plus-lg"></i></a>
    </div>
  </div>
{% endblock %}
